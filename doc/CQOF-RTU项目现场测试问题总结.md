## ZigBee网络

1. **当ZigBee网络中的路由器设备已经在一个网络中时，要想让其加入一个新的网络，就要对该路由器进行NR操作，清除之前的连接网络数据才可以**。

   或者更改为对应网络的PAN ID，这样也相当于清除了之前的连接的网络数据（目前括号里的这个结论只是针对现场测试得到的的一种现象解释，并未做最终定性）。

## 功图数据

1. **在井场RTU层，并不会对功图数据做处理，只是将井场接收到的功图数据通过对应的协议帧（A11）回传给服务器。**
2. **不论什么原因，当采不到井口RTU的功图数据时，各井场RTU厂家的处理方法各不相同，安控采用一张平直的线功图作为回传功图，安特则采用最后采集到的一张功图作为回传功图。根据与九场的朱玉龙主任沟通，他们更希望回传一张实时的不加其他处理的功图，这样方便服务器这边能够实时观察到各井口的真实情况，基于此以及招标文件上的要求，对功图数据，井场RTU只进行实时的采集并回传给服务器。**
3. **上位机读取功图数据时，一次性读取的数据长度超过井场通过ZigBee与井口进行数据传输的最大帧长度，故要进行分包处理**

## 阀组间

1. **根据现场配置的不同，可以选取的连接方式不同，通常分为有线（RS485）和无线（ZigBee）两种方式；以及不同厂家的阀组控制箱，通常为北京安控，浙江精华，上海一诺等。**

2. **不同厂家的阀组箱采用的寄存器地址并不相同（根据作业区的工作人员描述），但根据他们给的两份协议箱的说明书分析得：寄存器地址应当是同一个标准**。

   不过在当前测试的5个井场中，只有一个配置了阀组，所以缺少对比，不能做进一步的分析定论。

3. **通过对当前唯一的一口阀组间进行数据分析，其内部站号14~16对应上位机的126~128，并通过这个内部站号和井场RTU进行数据交换，而井场与上位机间的数据通讯则通过站号126~128进行。**

4. **阀组间的寄存器数据通过功能码04来获取，并将数据放入对应的井场主RTU数据寄存器表（A11）中。**

5. **阀组间的“注水井注水量设置值”寄存器为一可读写寄存器，服务器通常会发送写寄存器指令来设置该寄存器值，从而控制各注水井。**

## 汇管压力

1. **汇管压力一般接在各井口RTU的AI接口上，但是各厂家井口RTU的配置不同，数据处理方式也不相同。**

   目前测得安控井口RTU在汇管压力数据上并未做数据处理（与量程相乘得到的最终数据），此处为原始数据单位为Pa（而其一般的单位为MPa），之后在井场RTU上做了处理后再回传给服务器。

   而安特井口RTU会先将汇管压力做数据处理后，再发送给井场RTU，最后回传给服务器。

2. **传输方式也不相同。**

   安控和安特的高版本都可以通过04功能码直接读出各井口的AI数据，而安特的老版本并不能通过上述操作得到AI数据。但他们应该都可以通过对应油井的40051寄存器和40060寄存器得到汇管压力的数据。

3. **得到的汇管压力数据要放到井场主RTU数据寄存器表（A11）的40051寄存器中，如果有两个汇管压力的话，第二个汇管压力存放在40060寄存器中（站号为128）。**